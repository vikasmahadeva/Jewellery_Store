{% extends "base.html" %}
{% from "_csrf.html" import csrf_field %}

{% block title %}{{ 'New Product' if mode=='create' else 'Edit Product' }}{% endblock %}
{% block content %}
  <h3>{{ 'New Product' if mode=='create' else 'Edit Product' }}</h3>

  <form method="post" enctype="multipart/form-data">
    {{ csrf_field() }}

    <div class="mb-3">
      <label class="form-label">Name *</label>
      <input class="form-control" name="name" required value="{{ product.name if product else '' }}">
    </div>

    <div class="mb-3">
      <label class="form-label">Price *</label>
      <input class="form-control" name="price" type="number" step="0.01" required value="{{ product.price if product else '' }}">
    </div>
<div class="mb-3">
  <label class="form-label">Category</label>
  <select class="form-select" name="category">
    <option value="">Select Category</option>
    <option value="Gold" {% if product and product.category == 'Gold' %}selected{% endif %}>Gold</option>
    <option value="Silver" {% if product and product.category == 'Silver' %}selected{% endif %}>Silver</option>
    <option value="Platinum" {% if product and product.category == 'Platinum' %}selected{% endif %}>Platinum</option>
  </select>
</div>

<div class="mb-3">
  <label class="form-label">Subcategory</label>
  <select class="form-select" name="subcategory">
    <option value="">Select Subcategory</option>
    <option value="Necklace" {% if product and product.subcategory == 'Necklace' %}selected{% endif %}>Necklace</option>
    <option value="Long Haaram" {% if product and product.subcategory == 'Long Haaram' %}selected{% endif %}>Long Haaram</option>
    <option value="Ring" {% if product and product.subcategory == 'Ring' %}selected{% endif %}>Ring</option>
    <option value="Earrings" {% if product and product.subcategory == 'Earrings' %}selected{% endif %}>Earrings</option>
    <option value="Bracelet" {% if product and product.subcategory == 'Bracelet' %}selected{% endif %}>Bracelet</option>
    <option value="Other" {% if product and product.subcategory == 'Other' %}selected{% endif %}>Other</option>
  </select>
</div>


    <div class="mb-3">
      <label class="form-label">Stock *</label>
      <input class="form-control" name="stock" type="number" min="0" required value="{{ product.stock if product else '' }}">
    </div>

    <div class="mb-3">
      <label class="form-label">Upload Image</label>
      <input type="file" name="image_file" class="form-control">
      {% if product and product.image %}
        <div class="mt-2"><img src="{{ product.image }}" alt="Current Image" class="img-thumbnail" width="120"></div>
      {% endif %}
    </div>

    <div class="mb-3">
      <label class="form-label">Image URL</label>
      <input class="form-control" name="image" placeholder="https://..." value="{{ product.image if product else '' }}">
      <div class="form-text">Upload a file or paste a public image URL.</div>
    </div>

    <div class="mb-3">
      <label class="form-label">Description</label>
      <textarea class="form-control" name="description" rows="4">{{ product.description if product else '' }}</textarea>
    </div>

    <button class="btn btn-primary">Save</button>
    <a class="btn btn-outline-secondary" href="{{ url_for('admin.products_list') }}">Cancel</a>
  </form>

  {% if mode == 'edit' %}
    <form method="post" action="{{ url_for('admin.product_delete', pid=product.id) }}" class="mt-2">
      {{ csrf_field() }}
      <button class="btn btn-outline-danger">Delete</button>
    </form>
  {% endif %}
{% endblock %}
