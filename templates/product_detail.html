{% extends "base.html" %}
{% from "_csrf.html" import csrf_field %}

{% block title %}{{ product.name }}{% endblock %}
{% block content %}
<div class="row">
  <div class="col-md-5">
    <img src="{{ product.image or url_for('static', filename='placeholder.png') }}" class="img-fluid rounded" alt="{{ product.name }}" style="max-height:420px;object-fit:cover;">
  </div>

  <div class="col-md-7">
    <h2>{{ product.name }}</h2>
    <p class="text-muted">â‚¹ {{ '%.2f'|format(product.price) }}</p>
    <p>{{ product.description }}</p>
    <p><span class="badge bg-{{ 'success' if product.stock > 0 else 'secondary' }}">Stock: {{ product.stock }}</span></p>

    <form method="post" action="{{ url_for('product.add_to_cart', product_id=product.id) }}" class="d-flex gap-2">
      {{ csrf_field() }}
      <input type="number" name="qty" value="1" min="1" max="{{ product.stock }}" class="form-control" style="width:120px">
      <button class="btn btn-primary" {% if product.stock <= 0 %}disabled{% endif %}>Add to Cart</button>
    </form>

    {% if current_user.is_authenticated and current_user.is_admin %}
      <div class="mt-3">
        <a class="btn btn-outline-secondary btn-sm" href="{{ url_for('admin.product_edit', pid=product.id) }}">Edit (Admin)</a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
